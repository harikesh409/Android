define(['require', 'app'], function(require, APP) {

    /**
     * Controller for Screen1 generated by Appery.io
     * @module Screen1
     */

    APP.controller('Screen1', ['$scope', 'Apperyio', controller]);

    function controller($scope, Apperyio) {
        /**
         * User controller functions
         */
        /**
         * @function init
         */
        $scope.init = function() {
            //On load screen logic
        };

        /**
         * @function getWeather
         */
        $scope.getWeather = function() {
            var requestData = {};
            requestData = (function mapping3519($scope) {
                var requestData = {};
                requestData.params = {};
                var weather_scope = $scope.weather;
                requestData.params.location = weather_scope.location;

                return requestData; /*|button_mapping|onbeforesend|A70EBC06-22E7-11B2-CBB5-E782368E6B7D||3519|*/
            })($scope);

            // read more about using rest services: https://links.appery.io/ve-snippet-rest
            Apperyio.get("weatherAPI_conditions_weather_get")(requestData).then( /*|service_bookmark|bookmark|A70EBC06-22E7-11B2-CBB5-E782368E6B7D||1618|*/

            function(success) { // success callback
                (function mapping1625(success, $scope) {
                    var weather_scope = $scope.weather;
                    _.set(weather_scope, 'temperature', success.data.BODY.main.temp);
                    _.set(weather_scope, 'city', success.data.BODY.name);
                    _.set(weather_scope, 'location', success.data.BODY.name);
                    _.set(weather_scope, 'description', success.data.BODY.weather[0].main);
                    $scope.weather = weather_scope; /*|button_mapping|onsuccess|A70EBC06-22E7-11B2-CBB5-E782368E6B7D||1625|*/
                })(success, $scope);

            }, function(error) {
                console.log(error);
                document.addEventListener("push-notification", function() {});

            }, function(notify) { // notify callback, can fire few times
            });

        };

        /**
         * user controller variables
         */
        $scope.weather = Apperyio.EntityAPI('Weather');
    }

});